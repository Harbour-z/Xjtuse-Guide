# NP 完全性理论

## 基础知识

在开始学习 NP 完全性理论前，我们需要了解一些它们相关的基础概念

### 多项式时间复杂度

时间复杂度不超过 $n^\alpha$ 的算法属于多项式时间复杂度（其中 $\alpha$ 为任意的常数）

时间复杂度大于此的算法属于指数级时间复杂度。例如：

$O(n^2)$, $O(n^{114514})$ 都是多项式时间复杂度；O($2^{n}$) 级别的算法属于指数级时间复杂度。

> 也就是复杂度高于多项式级别的算法都是指数级时间复杂度

### 约化

如果一个问题 A 可以被约化为问题 B，就是说我们可以使用问题 B 的解法解决问题 A。

> 通常，这意味着问题 B 相对问题 A 更泛用、更困难

比如，计算一元一次方程的问题可以被约化为求解二元一次方程组，因为求解二元一次方程组所用的知识包含了所有求解一元一次方程所需的知识。

> 问题约化后，会变得更复杂、更困难

### 确定性图灵机和非确定性图灵机

以下内容并非准确的定义，只是一种笼统的描述。

确定性图灵机：必须按照程序「按部就班」运行的图灵机。

非确定性图灵机：可以「猜测」下一个步骤的图灵机，不完全按照给定程序运行。

> 举个例子：对于解二元一次方程这种问题，确定性图灵机会根据求解公式，带入方程系数，直接计算出方程的解；非确定性图灵机可以不断猜测两个未知数可能是什么，并带入原方程验证，直到猜测正确

所有非确定性图灵机能解决的问题都可以由确定性图灵机解决，只是时间耗时比较长。

> 通俗地说，可以把确定性图灵机理解为一般的计算机，它通过严格执行程序来求出问题的结果。
>
> 不确定性图灵机则通过疯狂猜测随机结果并验证，尝试找到问题的解。这种方法类似于做数学题时的思考过程：我们可能会先假设答案是某个特殊值（如 0、1、-1），然后通过题目验证，以尝试更快地找到正确答案。



## 四个问题

本章节一共包含四个概念：P 问题、NP 问题、NP-Hard 问题（又称 NP 难问题），NPC 问题（NP Complete，NP 完全问题）。

### P 类问题

在**多项式级时间复杂度内可以解决的问题**称为 P 类问题。比如，各种排序算法的时间复杂度一般都小于 $O(n^2)$，因此所有排序算法解决的问题都是 P 类问题。

为什么我们要研究这个呢？为什么以多项式为标准而不是其他的？

因为计算机处理的数据常常是非常大的，想象一下，当计算机处理的数据达到 100 万个的时候，时间复杂度为 $O(n^2)$ 和 $O(2^n)$ 的算法，所需的运行次数是天壤之别，指数级的可能运行好几天都没法完成任务，但多项式级别的时间是可以接受的。

所以我们也只在乎一个问题是否存在多项式算法，而一个时间复杂度比多项式还要复杂的算法研究起来是几乎没有意义的。

由于这类问题在多项式时间复杂度内可以解决，因此，给出一个问题的结果，我们自然可以在多项式时间内验证这一结果是否准确。

> 比如，「寻找所有 100 内的质数」这一问题是 P 问题（因为时间复杂度在 $O(n^2)$ 内），那么任意给定一个 100 内的数字，验证这个数字是否是质数自然可以在 $O(n^2)$ 内完成。毕竟，我可以通过求出所有可能的解，看看待验证结果是否在解中，来判定是否正确。

P 类问题是在确定型图灵机上多项式时间内可解决的问题。

### NP 类问题

**在多项式时间内可以验证**的问题称为 NP 类问题。即给出一个答案，可以在多项式时间内验证它是对的还是错的，但不一定能在多项式时间内求出所有的解。

比如，数独问题：给定一个 9x9 的数独，如果你是数独高手，可能能在五分钟内做完；但给你一个已完成的数独，就算你是小白，也能在一两分钟内判断出这个解是否正确。

再比如：Hamilton 路的寻找问题：如何在一张图中找到一条路，使得这条路通过所有图的节点一次。

如果要通过枚举求解这个问题，最多需要查找 (n-1)! 种路径；但如果要验证一条路，只需要查看这条路径，看看是否通过所有节点就行，属于 O(n) 的复杂度。

**P 类问题一定是 NP 类问题，但 NP 类问题不一定是 P 类问题**。

P 类问题中说到，「由于 P 类问题在多项式时间复杂度内可以解决，因此，给出一个问题的结果，我们自然可以在多项式时间内验证这一结果是否准确」，因此 P 类问题属于 NP 类问题；

但是，NP 类问题不一定是 P 类的。比如上面所说的寻找哈密顿路问题，解决它的时间复杂度是指数级的，但是验证的复杂度是多项式级的。

NP 类问题是在确定型图灵机上多项式时间可验证，在非确定型图灵机上多项式时间可解的问题

> 非确定性图灵机解 NP 类问题本质上是靠猜+验证

### P=NP？

> 以下问题目前还尚未被证明/证伪，只是一种猜想

上面提到，P 类问题一定是 NP 类问题，那会不会，NP 类问题也是 P 类问题，只是我们太菜了，还没找到 NP 类问题在多项式时间复杂度内的解法呢？

如果 NP 类问题都有多项式时间复杂度内解的话，意味着计算机就能很快的解决 NP 类问题了，很多算法的性能就会上一个大台阶。可问题是，NP 类问题有很多很多，我们该怎么证明，每个 NP 类问题都是/不是 P 类问题呢？

*基础概念部分*提到的「约化」在这里就派上了用场。由于「约化」是问题越来越难的过程，我们只要证明，所有 NP 问题能在多项式时间内约化成一个最难的 NP 问题，而且它有多项式时间复杂度内的解，就能证明 NP = P 了。这种「最难的 NP 问题」就是 NPC 问题。

不过，让我们先了解一下 NP-Hard 问题，再具体学习 NPC 问题

### NP-Hard 类问题（NP 难问题）

任意的 NP 问题可以在多项式时间内约化为此问题。

即为了解决 NP 问题 A，先将问题 A 约化为另一个问题 B，解决问题 B 同时也间接解决了问题 A。问题 B 就是一个 NP 难问题。

**NP 难问题不一定属于 NP 类问题**。这是因为，NP 难问题是 NP 问题约化来的，所以它会更难，有可能无法在多项式时间内验证。

举例：旅行商问题

假设一个人要从西安出发，经过北京、天津、上海、广州、深圳……等 n 个城市。每两个城市之间都有飞机直达，但是两个方向的票价不相等。请给出一条路径，使得这个人经过所有城市且花费的时间最少。

分析：想要知道所有方案中花费最少的，必须检查所有可能的旅行安排才能找到，即（n-1)! 种方案，很显然这不是P 问题。给出任意一个行程安排，你能算出它的总路费，但无法在多项式时间内验证这条路是否是最短路。所以不是 NP 问题。

此外，寻找 Hamilton 路的问题可以被约化为此问题：如果把寻找 Hamilton 路的问题复杂化，让图变为带权图且任何一条边双向的权重都不同，让求解目标从「寻找一条通过所有顶点的路径」变为「寻找一条通过所有顶点且总权重最低」的路径，寻找 Hamilton 路问题就变为了旅行商问题。因此，旅行商问题是 NP 难问题。

### NPC 类问题（NP-Complete, NP 完全问题）

**所有既是 NP 问题，又是 NP 难问题的问题**。

即：NPC 问题是一个 NP 问题，且任意的 NP 问题都可以约化到它。

举例：旅行商限制花费问题

假设一个人要从西安出发，经过北京、天津、上海、广州、深圳……等 n 个城市。每两个城市之间都有飞机直达，但是两个方向的票价不相等。公司最多报销 c 元，请问是否存在一个行程安排，使得此人能经过所有城市，且花费小于 C？

分析：想要知道所有方案中花费最少的，必须检查所有可能的旅行安排才能找到，即（n-1)! 种方案，很显然这不是 P 问题。给出任意一个行程安排，你能算出它的总路费，且可以检查总路费是否小于 C。所以是 NP 问题。此外，寻找 Hamilton 路的问题可以被约化为此问题，所以这个问题是 NP-Hard 问题。

由于此问题既是 NP-Hard 问题又是 NP 问题，因此它是 NPC 问题。

> 严格上讲，这个问题不是 NPC 问题，因为我们没有证明所有 NP 问题都能约化到此问题，只证明了有一个可以。这个例子不是很严谨

NPC 问题的价值上面已经提到过：在多项式时间复杂度内解决了一个 NPC 问题，就证明所有 NP 问题都可以在多项式时间复杂度内完成，即证明了 P=NP。

### 四种问题的关系

具体关系在介绍每种问题时都已经提到了，这里放一张总结图片

![image-20240928143722309](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AANyZ6Rj7Q7Ia15_xIKb78zUn0pm69cAAswUAAIHrilVhkTJQGw4AAFONgQ.png)



## 引用

[P 问题，NP 问题，NPH 问题，NPC 问题介绍](https://www.bilibili.com/video/BV1pF41127B3)

> 个人认为上方这个视频讲解清晰，非常值得一看

[第一章 算法概述与NP完全性理论](https://xjtuse-guide.github.io/Xjtuse-Guide/#/docs/课内笔记/大三上/算法分析与设计-选修/笔记/易俊泉/1.1算法概述?id=第一章-算法概述与np完全性理论)

[P问题、NP问题、NP完全问题和NP难问题](https://zhuanlan.zhihu.com/p/73953567)